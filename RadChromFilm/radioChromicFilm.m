% import datafilename = "peliculaRadiocromica2.xlsx";UM_range = 'A3:A10';mean_range = 'H3:H10';UM = readmatrix(filename,'Sheet','normal','Range',UM_range);red = readmatrix(filename,'Sheet','red','Range',mean_range);blue = readmatrix(filename,'Sheet','blue','Range',mean_range);green = readmatrix(filename,'Sheet','green','Range',mean_range);%% Curve Fitting[redFit, rSqrRed] = fit(red,UM,'poly1');[blueFit, rSqrBlue] = fit(blue,UM,'poly1');[greenFit, rSqrGreen] = fit(green,UM,'poly1');save redFunction.mat redFit rSqrRed;save blueFunction.mat blueFit rSqrBlue;save greenFunction.mat greenFit rSqrGreen;%% ErrorsyRed = abs(UM-redFit(red));yBlue = abs(UM-blueFit(blue));yGreen = abs(UM-greenFit(green));%% Plot Redfigure;txt = 'p1(x) + p2 with p1 = 1880, p2 = -68.55 and r^{2} = 0.93';hold on;plot(redFit,red,UM,'*');errorbar(red,UM,yRed,'--b');title('Calibration curve fot EBT3 in red channel');subtitle(txt);xlabel('Optical density');ylabel('Dose (cGy)');legend('Orignal data','Linear fit');%% Plot Bluefigure;txt = 'p1(x) + p2 with p1 = 5412, p2 = -52.87 and r^{2} = 0.95';hold on;plot(blueFit,blue,UM,'*');errorbar(blue,UM,yBlue,'--b');title('Calibration curve fot EBT3 in blue channel');subtitle(txt);xlabel('Optical density');ylabel('Dose (cGy)');legend('Orignal data','Linear fit');%% Plot Greenfigure;txt = 'p1(x) + p2 with p1 = 2568, p2 = -50.21 and r^{2} = 0.968';hold on;plot(greenFit,green,UM,'*');errorbar(green,UM,yGreen,'--g');title('Calibration curve fot EBT3 in green channel');subtitle(txt);xlabel('Optical density');ylabel('Dose (cGy)');legend('Orignal data','Linear fit');%% All original curves plottedfigure;hold on;errorbar(green,UM,yGreen,'--g');errorbar(blue,UM,yBlue,'--b');errorbar(red,UM,yRed,'--r');title('All color channels comparison');subtitle('Irving O. Ayala Iturbe');xlabel('Optical density');ylabel('Dose (cGy)');%% All fitted curves plottedfigure;hold on;plot(redFit,red,UM,'*r');plot(blueFit,blue,UM,'*b');plot(greenFit,green,UM,'*g');title('All color fit comparison');subtitle('Irving O. Ayala Iturbe');xlabel('Optical density');ylabel('Dose (cGy)');%% Importing old radfilm dataoldData = 'measur_IonizChamb_ABC.xlsx';oldDose = readmatrix(oldData,'Sheet','Rad Film','Range','B25:B29');oldred = readmatrix(oldData,'Sheet','Rad Film','Range','B18:B22');oldblue = readmatrix(oldData,'Sheet','Rad Film','Range','F18:F22');oldgreen = readmatrix(oldData,'Sheet','Rad Film','Range','J18:J22');%% Evaluating model from actual filmsoldRedResult = redFit(oldred);oldBlueResult = blueFit(oldblue);oldGreenResult = greenFit(oldgreen);%% Comparing response in old data%oldDose = oldDose/100;for i=1:5    oldErrorRed(i) = abs(oldDose(i)-oldRedResult(i))/oldDose(i);     oldErrorBlue(i) = abs(oldDose(i)-oldBlueResult(i))/oldDose(i);     oldErrorGreen(i) = abs(oldDose(i)-oldGreenResult(i))/oldDose(i); end%% Plotting old films - Blue%oldDose = oldDose*100;figure();hold on;plot(oldblue,oldBlueResult,'-r');plot(oldblue,oldDose,'-.b');legend('Curve fitted','original data');xlabel('Optical Density (a.u)');ylabel('Dose (cGy)');title('Comparation of model vs old film data for blue channel');%% Plotting old films - Green%oldDose = oldDose*100;figure();hold on;plot(oldgreen,oldGreenResult,'-r');plot(oldgreen,oldDose,'-.b');legend('Curve fitted','original data');xlabel('Optical Density (a.u)');ylabel('Dose (cGy)');title('Comparation of model vs old film data for green channel');%% Plotting old films - Red%oldDose = oldDose*100;figure();hold on;plot(oldred,oldRedResult,'-r');plot(oldred,oldDose,'-.b');legend('Curve fitted','original data');xlabel('Optical Density (a.u)');ylabel('Dose (cGy)');title('Comparation of model vs old film data for red channel');%% Error comparison from old datayvalues = {'Red','Blue','Green'};xvalues = {'1','2','3','4','5'};h= heatmap(xvalues,yvalues,[oldErrorRed;oldErrorBlue;oldErrorGreen],'Colormap',pink(8));title('Error in RGB channels');